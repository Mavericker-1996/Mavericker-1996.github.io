<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TodoMVC Example | Mavericker&#39;s Blog</title>
    <meta name="description" content="赵佐骑的个人博客，前端">
    <link rel="icon" href="/fav.ico">
  <script type="text/javascript">var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?5a982c6c5e0d0d786523e60a7a647022";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script>
    
    <link rel="preload" href="/assets/css/0.styles.76307617.css" as="style"><link rel="preload" href="/assets/js/app.813c17b6.js" as="script"><link rel="preload" href="/assets/js/55.6713f330.js" as="script"><link rel="prefetch" href="/assets/js/12.e71bc87f.js"><link rel="prefetch" href="/assets/js/2.b8909fec.js"><link rel="prefetch" href="/assets/js/3.8d04fbbf.js"><link rel="prefetch" href="/assets/js/4.76cb4dbf.js"><link rel="prefetch" href="/assets/js/5.82846fcf.js"><link rel="prefetch" href="/assets/js/6.d026f6bc.js"><link rel="prefetch" href="/assets/js/7.614c0c26.js"><link rel="prefetch" href="/assets/js/8.91f64669.js"><link rel="prefetch" href="/assets/js/9.bd03efb0.js"><link rel="prefetch" href="/assets/js/10.b72941af.js"><link rel="prefetch" href="/assets/js/11.55c4af94.js"><link rel="prefetch" href="/assets/js/13.1b4e26a1.js"><link rel="prefetch" href="/assets/js/14.6ce88fa2.js"><link rel="prefetch" href="/assets/js/15.53815097.js"><link rel="prefetch" href="/assets/js/16.3d021803.js"><link rel="prefetch" href="/assets/js/17.ac6b335f.js"><link rel="prefetch" href="/assets/js/18.539a72e1.js"><link rel="prefetch" href="/assets/js/19.46c5d299.js"><link rel="prefetch" href="/assets/js/20.bbe25a47.js"><link rel="prefetch" href="/assets/js/21.b57b41b7.js"><link rel="prefetch" href="/assets/js/22.24104113.js"><link rel="prefetch" href="/assets/js/23.a1aadb14.js"><link rel="prefetch" href="/assets/js/24.7f66a479.js"><link rel="prefetch" href="/assets/js/25.0d998f42.js"><link rel="prefetch" href="/assets/js/26.0448ab80.js"><link rel="prefetch" href="/assets/js/27.20ca2d83.js"><link rel="prefetch" href="/assets/js/28.56900e6e.js"><link rel="prefetch" href="/assets/js/29.580fb71b.js"><link rel="prefetch" href="/assets/js/30.9b752411.js"><link rel="prefetch" href="/assets/js/31.71a3e01f.js"><link rel="prefetch" href="/assets/js/32.633b1158.js"><link rel="prefetch" href="/assets/js/33.f80c8c22.js"><link rel="prefetch" href="/assets/js/34.f4d2a30d.js"><link rel="prefetch" href="/assets/js/35.3ad15739.js"><link rel="prefetch" href="/assets/js/36.324804a5.js"><link rel="prefetch" href="/assets/js/37.59925d68.js"><link rel="prefetch" href="/assets/js/38.e6f8d299.js"><link rel="prefetch" href="/assets/js/39.46060081.js"><link rel="prefetch" href="/assets/js/40.92805123.js"><link rel="prefetch" href="/assets/js/41.8516a958.js"><link rel="prefetch" href="/assets/js/42.985e6416.js"><link rel="prefetch" href="/assets/js/43.770aaa1a.js"><link rel="prefetch" href="/assets/js/44.56039045.js"><link rel="prefetch" href="/assets/js/45.07330c76.js"><link rel="prefetch" href="/assets/js/46.6d200ff4.js"><link rel="prefetch" href="/assets/js/47.2ecec06c.js"><link rel="prefetch" href="/assets/js/48.2a749d70.js"><link rel="prefetch" href="/assets/js/49.5defabfe.js"><link rel="prefetch" href="/assets/js/50.391c2931.js"><link rel="prefetch" href="/assets/js/51.823ddd3e.js"><link rel="prefetch" href="/assets/js/52.272e9779.js"><link rel="prefetch" href="/assets/js/53.dd41478f.js"><link rel="prefetch" href="/assets/js/54.bdd75c33.js"><link rel="prefetch" href="/assets/js/56.19a9b3e2.js"><link rel="prefetch" href="/assets/js/57.30130f5c.js"><link rel="prefetch" href="/assets/js/58.63ce249b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.76307617.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Mavericker's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/network/" class="nav-link">网络</a></div><div class="nav-item"><a href="/css/" class="nav-link">CSS</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/basic/" class="nav-link">JavaScript基础</a></li><li class="dropdown-item"><!----> <a href="/javascript/pro/" class="nav-link">JavaScript专题</a></li></ul></div></div><div class="nav-item"><a href="/vue/" class="nav-link router-link-active">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link">React</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">算法</a></div><div class="nav-item"><a href="/article/" class="nav-link">文章</a></div><div class="nav-item"><a href="/resume/" class="nav-link">个人简历</a></div><div class="nav-item"><a href="https://github.com/Mavericker-1996/Mavericker-1996.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/network/" class="nav-link">网络</a></div><div class="nav-item"><a href="/css/" class="nav-link">CSS</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/basic/" class="nav-link">JavaScript基础</a></li><li class="dropdown-item"><!----> <a href="/javascript/pro/" class="nav-link">JavaScript专题</a></li></ul></div></div><div class="nav-item"><a href="/vue/" class="nav-link router-link-active">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link">React</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">算法</a></div><div class="nav-item"><a href="/article/" class="nav-link">文章</a></div><div class="nav-item"><a href="/resume/" class="nav-link">个人简历</a></div><div class="nav-item"><a href="https://github.com/Mavericker-1996/Mavericker-1996.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vue/" class="sidebar-link">Vue基本概念</a></li><li><a href="/vue/Vue组件.html" class="sidebar-link">Vue组件</a></li><li><a href="/vue/Vue双向绑定原理.html" class="sidebar-link">Vue双向绑定原理</a></li><li><a href="/vue/Vue-cli中webpack配置分析.html" class="sidebar-link">Vue-cli中webpack配置代码分析</a></li><li><a href="/vue/TodoMVC.html" class="active sidebar-link">TodoMVC Example</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/TodoMVC.html#关于todomvc" class="sidebar-link">关于TodoMVC</a></li><li class="sidebar-sub-header"><a href="/vue/TodoMVC.html#功能要求" class="sidebar-link">功能要求</a></li><li class="sidebar-sub-header"><a href="/vue/TodoMVC.html#代码实现" class="sidebar-link">代码实现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/TodoMVC.html#存储数据部分" class="sidebar-link">存储数据部分</a></li><li class="sidebar-sub-header"><a href="/vue/TodoMVC.html#筛选部分" class="sidebar-link">筛选部分</a></li><li class="sidebar-sub-header"><a href="/vue/TodoMVC.html#vue实例部分" class="sidebar-link">Vue实例部分</a></li><li class="sidebar-sub-header"><a href="/vue/TodoMVC.html#添加新todo部分" class="sidebar-link">添加新todo部分</a></li><li class="sidebar-sub-header"><a href="/vue/TodoMVC.html#显示todo列表部分" class="sidebar-link">显示todo列表部分</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/TodoMVC.html#总结" class="sidebar-link">总结</a></li></ul></li></ul> </div> <div class="page"> <div class="content"><h1 id="todomvc-example"><a href="#todomvc-example" aria-hidden="true" class="header-anchor">#</a> TodoMVC Example</h1> <p><a href="https://blog.csdn.net/caspernan/article/details/78244110" target="_blank" rel="noopener noreferrer">参考文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="关于todomvc"><a href="#关于todomvc" aria-hidden="true" class="header-anchor">#</a> 关于TodoMVC</h2> <p>官方介绍如下：</p> <blockquote><p>Developers these days are spoiled with choice when it comes to <a href="http://coding.smashingmagazine.com/2012/07/27/journey-through-the-javascript-mvc-jungle/" target="_blank" rel="noopener noreferrer">selecting<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> an <strong>MV* framework</strong> for structuring and organizing their JavaScript web apps.</p> <p>Backbone, Ember, AngularJS… the list of new and stable solutions continues to grow, but just how do you decide on which to use in a sea of so many options?</p> <p>To help solve this problem, we created <a href="https://github.com/tastejs/todomvc" target="_blank" rel="noopener noreferrer">TodoMVC<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> - a project which offers the same Todo application implemented using MV* concepts in most of the popular JavaScript MV* frameworks of today.</p></blockquote> <p>简单来说就是一个Google团队发起的一个项目，目的是让世面上众多框架实现一个相同的<code>TodoList</code>demo。好让初学者进行技术选型。</p> <h2 id="功能要求"><a href="#功能要求" aria-hidden="true" class="header-anchor">#</a> 功能要求</h2> <ol><li>点击输入框，输入内容，按下回车键就会在下面增加一项todo</li> <li>鼠标悬浮到一条todo时，右边会显示x删除图标，点击即可进行删除，左边会显示完成图标，点击即添加到完成列表中。</li> <li>双击一条todo可以对其进行编辑，按回车键完成编辑。</li> <li>可以查看已完成的todo和未完成的todo</li> <li>可以全部选中，进行清空，切换状态操作</li></ol> <h2 id="代码实现"><a href="#代码实现" aria-hidden="true" class="header-anchor">#</a> 代码实现</h2> <h3 id="存储数据部分"><a href="#存储数据部分" aria-hidden="true" class="header-anchor">#</a> 存储数据部分</h3> <p>我们通过localStorage对todolist进行存储，其中每一项包含的属性有<code>id</code>，内容<code>title</code>，是否已完成<code>completed</code>。这里我们封装一个<code>todoStorage</code>对象，里面包含了两个方法：<code>fetch</code>和<code>save</code>。</p> <p>在<code>fetch</code>方法中我们首先通过<code>getItem</code>方法获得todos，由于<code>setItem</code>函数接受的两个参数都是字符串，所以需要使用<code>JSON.parse</code>和<code>JSON.stringify</code>两个函数进行转化。然后为了防止出现id重复的现象，我们需要在每次获取todos的时候对其中的id进行按index赋值，然后通过一个<code>uid</code>参数来记录其长度，之后添加的时候id赋值为uid++即可。最后我们将todos返回。</p> <p>在<code>save</code>方法中我们通过<code>setItem</code>方法对其进行存储即可。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//存储数据部分</span>
<span class="token keyword">const</span> <span class="token constant">STORAGE_KEY</span> <span class="token operator">=</span> <span class="token string">'todos-vuejs-2.0'</span>
<span class="token keyword">var</span> todoStorage <span class="token operator">=</span> <span class="token punctuation">{</span>
  fetch<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch succeed'</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> todos <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token constant">STORAGE_KEY</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    todos<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>todo<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//防止出现index重复的现象</span>
      todo<span class="token punctuation">.</span>id <span class="token operator">=</span> index<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    todoStorage<span class="token punctuation">.</span>uid <span class="token operator">=</span> todos<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">return</span> todos<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  save<span class="token punctuation">:</span> <span class="token punctuation">(</span>todos<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'save succeed'</span><span class="token punctuation">)</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token constant">STORAGE_KEY</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>todos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="筛选部分"><a href="#筛选部分" aria-hidden="true" class="header-anchor">#</a> 筛选部分</h3> <p>为了方便调用，我们封装了一个<code>filters</code>对象对要显示的todos进行管理，其中包括三个方法：<code>all</code>，<code>active</code>，<code>completed</code>。分别对应筛选这三个状态的todos。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//筛选部分</span>
<span class="token keyword">var</span> filters <span class="token operator">=</span> <span class="token punctuation">{</span>
  all<span class="token punctuation">:</span> <span class="token punctuation">(</span>todos<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todos<span class="token punctuation">,</span>
  active<span class="token punctuation">:</span> <span class="token punctuation">(</span>todos<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>todo <span class="token operator">=&gt;</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//筛选出未完成的</span>
  completed<span class="token punctuation">:</span> <span class="token punctuation">(</span>todos<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>todo <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>completed<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//筛选出已完成的</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="vue实例部分"><a href="#vue实例部分" aria-hidden="true" class="header-anchor">#</a> Vue实例部分</h3> <p>由于Vue实例中一些内容不知在哪里写，就在这里先写一部分。首先我们要用一个变量<code>app</code>来代码Vue实例，这个之后在监听<code>hashchange</code>事件会用到。</p> <p>对于实例中的data，在这里也全部列出，后面有每一个变量的作用。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    todos<span class="token punctuation">:</span> todoStorage<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    newTodo<span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token comment">//添加输入框输入的内容</span>
    visibility<span class="token punctuation">:</span><span class="token string">'all'</span><span class="token punctuation">,</span><span class="token comment">//控制显示的内容</span>
    editedTodo<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">//处于编辑状态的todo</span>
    beforeEditCache<span class="token punctuation">:</span><span class="token string">''</span><span class="token comment">//编辑之前缓存的title</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>然后我们需要在<code>watch</code>接口中监听todos这个变量,当发现它变化的时候，我们就调用<code>todoStorage.save()</code>函数将其存储起来。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">//监听todos变化，变化则存起来</span>
  watch<span class="token punctuation">:</span><span class="token punctuation">{</span>
  	todos<span class="token punctuation">:</span><span class="token punctuation">{</span>
    	handler<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>newtodos<span class="token punctuation">)</span><span class="token punctuation">{</span>
      	todoStorage<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>newtodos<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      deep<span class="token punctuation">:</span><span class="token boolean">true</span> <span class="token comment">//监听内部变化</span>
    <span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>然后需要一个过滤器<code>filters</code>来处理接下来显示<code>item</code>的单复数问题，关于filters的使用，可以参考<a href="https://cn.vuejs.org/v2/guide/filters.html" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">//单复数转化过滤器</span>
  filters<span class="token punctuation">:</span><span class="token punctuation">{</span>
  	pluralize<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token keyword">return</span> n <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">'item'</span> <span class="token punctuation">:</span> <span class="token string">'items'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>接下来我们需要设置一些计算属性来满足我们的需求：关于计算属性的使用，可以参考<a href="https://cn.vuejs.org/v2/guide/computed.html" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <ol><li>remaining：用来返回剩余未完成todo的数量。</li> <li>allDone：用来绑定全选开关的计算属性，它有一个<code>get</code>函数和<code>set</code>函数，对于<code>get</code>函数，它返回的是是否全部todo已经完成。对于<code>set</code>函数，它是当我们手动操作这个开关对allDone进行赋值时我们将所有todo进行全部完成和全部待完成的操作，即将每一项todo中completed的值设为与allDone相同的值。</li> <li>filteredTodos：用来返回我们要显示的todo列表，根据当前的<code>visibility</code>我们调用<code>filters</code>这个对象中的方法进行筛选。</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">//相关计算属性</span>
  computed<span class="token punctuation">:</span><span class="token punctuation">{</span>
  	remaining<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//返回剩余未完成todo的数量</span>
    	<span class="token keyword">return</span> filters<span class="token punctuation">.</span><span class="token function">active</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    allDone<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token comment">//全选开关的计算属性</span>
    	<span class="token keyword">get</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//全部todo完成时为true</span>
      	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>remaining<span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//全选或者全不选</span>
      	<span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>todo<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        	todo<span class="token punctuation">.</span>completed <span class="token operator">=</span> val<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    filteredTodos<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//返回要显示的内容</span>
    	<span class="token keyword">return</span> filters<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>visibility<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>在后面的双击todo进行编辑的时候，我们需要实现一个自定义指令使其双击后聚焦到编辑输入框上，我们通过editedTodo是否等于当前的todo进行判断是否发生了双击事件，关于自定义指令的使用，可以参考<a href="https://cn.vuejs.org/v2/guide/custom-directive.html" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">//自定义聚焦指令，使得双击todo后聚焦到input上</span>
  directives<span class="token punctuation">:</span><span class="token punctuation">{</span>
  	<span class="token string">'todo-focus'</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span>binding<span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>binding<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//value对应的html中传入的todo == editedTodo对应的值</span>
      	el<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="添加新todo部分"><a href="#添加新todo部分" aria-hidden="true" class="header-anchor">#</a> 添加新todo部分</h3> <p>对于界面中的输入框部分，我们通过<code>v-model</code>为其绑定了一个变量<code>newTodo</code>来代表输入的内容。同时为其绑定了一个按下键盘<code>enter</code>的事件。在这个事件中我们执行添加新todo操作。HTML代码如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>header<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>title<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>todos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>newtodo<span class="token punctuation">'</span></span> 
           <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>What needs to be done?<span class="token punctuation">&quot;</span></span> 
           <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>off<span class="token punctuation">'</span></span> 
           <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>newTodo<span class="token punctuation">'</span></span> 
           <span class="token attr-name">@keyup.enter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>addTodo<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>然后我们需要一个在输入框的左边放一个全选按钮，类型是checkbox，这时我们需要通过<code>v-model</code>为其绑定一个计算属性<code>allDone</code>。对于键盘<code>enter</code>事件绑定的添加函数，我们先需要对其进行<code>trim()</code>操作过滤掉两边多余的空格，然后将值push到todos数组里面去，并带上相应的id和completed值（统一设为false）。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  	<span class="token comment">//添加todo</span>
  	addTodo<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>newTodo <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>newTodo<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
      	<span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      	id<span class="token punctuation">:</span>todoStorage<span class="token punctuation">.</span>uid<span class="token operator">++</span><span class="token punctuation">,</span><span class="token comment">//先赋值再增加</span>
        title<span class="token punctuation">:</span>value<span class="token punctuation">,</span>
        completed<span class="token punctuation">:</span><span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>newTodo <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="显示todo列表部分"><a href="#显示todo列表部分" aria-hidden="true" class="header-anchor">#</a> 显示todo列表部分</h3> <p>这个部分相对比较复杂，也是这个项目中的核心部分，首先我们用<code>&lt;ul&gt;</code>标签来存储todo列表，用<code>&lt;li&gt;</code>标签来存储todo列表中的每一项。在<code>&lt;li&gt;</code>标签中我们通过<code>v-for</code>对<code>filteredTodos</code>返回的内容进行遍历，同时要根据每一项的completed属性和是否处在编辑状态（根据editedTodo是否等于当前的todo进行判断）来绑定不同的class。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>todo-list<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>todo<span class="token punctuation">'</span></span> 
          <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>todo in filteredTodos<span class="token punctuation">'</span></span> 
          <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>todo.id<span class="token punctuation">'</span></span>
          <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>{completed:todo.completed,editing:todo==editedTodo}<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>接下来我们来说每个<code>&lt;li&gt;</code>标签里面的内容：</p> <p>首先左边有一个切换状态的按钮，类型为checkbox，我们通过<code>v-model</code>将其绑定在每一个todo的completed属性上。</p> <p>接着中间显示内容，我们需要为其绑定一个<code>dblclick</code>双击事件，双击后对其进行编辑。</p> <p>最后右边有一个删除按钮，点击执行删除操作。</p> <p>然后当双击一个todo后处于编辑状态的时候，我们需要一个input输入框，对其进行编辑。对于这个编辑输入框：</p> <ol><li>我们需要通过<code>v-model</code>将其绑定到每一个todo的title属性上。</li> <li>为其绑定<code>v-todo-focus</code>自动聚焦指令。</li> <li>当失去焦点(blur)和按下<code>enter</code>键的时候，绑定完成编辑函数。</li> <li>当按下<code>esc</code>键的时候，绑定取消编辑函数。所以之前要通过一个变量将之前的title值存起来。</li></ol> <div class="language-html line-numbers-mode"><pre class="language-html"><code>          <span class="token comment">&lt;!--正常状态显示的view--&gt;</span>          
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>view<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--左边切换状态按钮--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>toggle<span class="token punctuation">'</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>checkbox<span class="token punctuation">'</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>todo.completed<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--中间todo内容--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">@dblclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>editTodo(todo)<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>{{todo.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--右边删除按钮--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>delete<span class="token punctuation">'</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>removeTodo(todo)<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    
          
          <span class="token comment">&lt;!--编辑状态状态显示的input--&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>edit<span class="token punctuation">'</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>text<span class="token punctuation">'</span></span>
            <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>todo.title<span class="token punctuation">'</span></span>
            <span class="token attr-name">v-todo-focus</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>todo == editedTodo<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">@blur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>doneEdit(todo)<span class="token punctuation">'</span></span>
            <span class="token attr-name">@keyup.enter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>doneEdit(todo)<span class="token punctuation">'</span></span>
            <span class="token attr-name">@keyup.esc</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>cancelEdit(todo)<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>       
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>对于删除todo函数，我们在todos中删除对应的todo即可。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">//删除todo</span>
    removeTodo<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>对于编辑todo函数，我们先将当前的title值存起来，然后将editedTodo赋值为todo。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">//编辑todo</span>
    editTodo<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token keyword">this</span><span class="token punctuation">.</span>beforeEditCache <span class="token operator">=</span> todo<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>editedTodo <span class="token operator">=</span> todo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>对于完成编辑函数，我们先将editedTodo赋值为null释放出来，然后再判断编辑后的内容trim()后是否还有内容，否则就remove掉即可。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">//完成编辑</span>
    doneEdit<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token keyword">this</span><span class="token punctuation">.</span>editedTodo <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      todo<span class="token punctuation">.</span>title <span class="token operator">=</span> todo<span class="token punctuation">.</span>title<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>todo<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">{</span>
      	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeTodo</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>对于取消编辑函数，我们先将editedTodo赋值为null释放出来，然后将之前缓存的title值赋过去即可。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">//取消编辑</span>
    cancelEdit<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>editedTodo <span class="token operator">=</span> <span class="token keyword">null</span>
      todo<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>beforeEditCache
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>###筛选按钮组部分</p> <p>对于这一部分，我们采用<code>&lt;a&gt;</code>标签来模拟按钮操作，之所以这样是因为我们可以在href中设置不同的hash值来进行传参，即携带不同的visibility的值，然后通过<code>onhashchange</code>事件进行捕获参数进行相应的赋值操作，visibility值变化则使computed中的filteredTodos函数返回值变化,则实现切换任务状态可见。关于hash的介绍，可以参考<a href="https://www.cnblogs.com/carriezhao/p/6861319.html" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token comment">&lt;!--按钮部分--&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>filters<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#/all<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{ selected: visibility == <span class="token punctuation">'</span>all<span class="token punctuation">'</span> }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>All<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#/active<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{ selected: visibility == <span class="token punctuation">'</span>active<span class="token punctuation">'</span> }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Active<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#/completed<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{ selected: visibility == <span class="token punctuation">'</span>completed<span class="token punctuation">'</span> }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Completed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
 <span class="token comment">&lt;!--清空所有已完成todo，即当todos.length-remaining&gt;0的时候--&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>clear-completed<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>removeCompleted<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>todos.length &gt; remaining<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        Clear completed
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//监听hash值变化</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> visibility <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/#\//</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>visibility<span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span>visibility <span class="token operator">=</span> visibility<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>对于清楚所有已完成的todo，我们只需将当前的todos设为所有未完成的todo即可。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">//删除全部已完成todo</span>
    removeCompleted<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token keyword">this</span><span class="token punctuation">.</span>todos <span class="token operator">=</span> filters<span class="token punctuation">[</span><span class="token string">'active'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h2> <p>最终效果如下：看不见的可以看<a href="//jsfiddle.net/Mavericker/n6rL590g/278/embedded/">这里</a>。</p> <iframe width="100%" height="600" src="//jsfiddle.net/Mavericker/n6rL590g/278/embedded/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe> <p>通过本demo使我对vue的相关掌握更加熟练，包括之前没有用过的一些像自定义指令，过滤器的内容，不得不佩服官方的源码写的很简洁漂亮，还是要多看好代码，多模仿，多实践。</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/vue/Vue-cli中webpack配置分析.html" class="prev">
          Vue-cli中webpack配置代码分析
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/assets/js/55.6713f330.js" defer></script><script src="/assets/js/app.813c17b6.js" defer></script>
  </body>
</html>
