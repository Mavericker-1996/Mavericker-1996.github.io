<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>this相关 | Mavericker&#39;s Blog</title>
    <meta name="description" content="赵佐骑的个人博客，前端">
    <link rel="icon" href="/fav.ico">
  <script type="text/javascript">var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?5a982c6c5e0d0d786523e60a7a647022";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script>
    
    <link rel="preload" href="/assets/css/0.styles.76307617.css" as="style"><link rel="preload" href="/assets/js/app.813c17b6.js" as="script"><link rel="preload" href="/assets/js/23.a1aadb14.js" as="script"><link rel="prefetch" href="/assets/js/12.e71bc87f.js"><link rel="prefetch" href="/assets/js/2.b8909fec.js"><link rel="prefetch" href="/assets/js/3.8d04fbbf.js"><link rel="prefetch" href="/assets/js/4.76cb4dbf.js"><link rel="prefetch" href="/assets/js/5.82846fcf.js"><link rel="prefetch" href="/assets/js/6.d026f6bc.js"><link rel="prefetch" href="/assets/js/7.614c0c26.js"><link rel="prefetch" href="/assets/js/8.91f64669.js"><link rel="prefetch" href="/assets/js/9.bd03efb0.js"><link rel="prefetch" href="/assets/js/10.b72941af.js"><link rel="prefetch" href="/assets/js/11.55c4af94.js"><link rel="prefetch" href="/assets/js/13.1b4e26a1.js"><link rel="prefetch" href="/assets/js/14.6ce88fa2.js"><link rel="prefetch" href="/assets/js/15.53815097.js"><link rel="prefetch" href="/assets/js/16.3d021803.js"><link rel="prefetch" href="/assets/js/17.ac6b335f.js"><link rel="prefetch" href="/assets/js/18.539a72e1.js"><link rel="prefetch" href="/assets/js/19.46c5d299.js"><link rel="prefetch" href="/assets/js/20.bbe25a47.js"><link rel="prefetch" href="/assets/js/21.b57b41b7.js"><link rel="prefetch" href="/assets/js/22.24104113.js"><link rel="prefetch" href="/assets/js/24.7f66a479.js"><link rel="prefetch" href="/assets/js/25.0d998f42.js"><link rel="prefetch" href="/assets/js/26.0448ab80.js"><link rel="prefetch" href="/assets/js/27.20ca2d83.js"><link rel="prefetch" href="/assets/js/28.56900e6e.js"><link rel="prefetch" href="/assets/js/29.580fb71b.js"><link rel="prefetch" href="/assets/js/30.9b752411.js"><link rel="prefetch" href="/assets/js/31.71a3e01f.js"><link rel="prefetch" href="/assets/js/32.633b1158.js"><link rel="prefetch" href="/assets/js/33.f80c8c22.js"><link rel="prefetch" href="/assets/js/34.f4d2a30d.js"><link rel="prefetch" href="/assets/js/35.3ad15739.js"><link rel="prefetch" href="/assets/js/36.324804a5.js"><link rel="prefetch" href="/assets/js/37.59925d68.js"><link rel="prefetch" href="/assets/js/38.e6f8d299.js"><link rel="prefetch" href="/assets/js/39.46060081.js"><link rel="prefetch" href="/assets/js/40.92805123.js"><link rel="prefetch" href="/assets/js/41.8516a958.js"><link rel="prefetch" href="/assets/js/42.985e6416.js"><link rel="prefetch" href="/assets/js/43.770aaa1a.js"><link rel="prefetch" href="/assets/js/44.56039045.js"><link rel="prefetch" href="/assets/js/45.07330c76.js"><link rel="prefetch" href="/assets/js/46.6d200ff4.js"><link rel="prefetch" href="/assets/js/47.2ecec06c.js"><link rel="prefetch" href="/assets/js/48.2a749d70.js"><link rel="prefetch" href="/assets/js/49.5defabfe.js"><link rel="prefetch" href="/assets/js/50.391c2931.js"><link rel="prefetch" href="/assets/js/51.823ddd3e.js"><link rel="prefetch" href="/assets/js/52.272e9779.js"><link rel="prefetch" href="/assets/js/53.dd41478f.js"><link rel="prefetch" href="/assets/js/54.bdd75c33.js"><link rel="prefetch" href="/assets/js/55.6713f330.js"><link rel="prefetch" href="/assets/js/56.19a9b3e2.js"><link rel="prefetch" href="/assets/js/57.30130f5c.js"><link rel="prefetch" href="/assets/js/58.63ce249b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.76307617.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Mavericker's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/network/" class="nav-link">网络</a></div><div class="nav-item"><a href="/css/" class="nav-link">CSS</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/basic/" class="nav-link router-link-active">JavaScript基础</a></li><li class="dropdown-item"><!----> <a href="/javascript/pro/" class="nav-link">JavaScript专题</a></li></ul></div></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link">React</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">算法</a></div><div class="nav-item"><a href="/article/" class="nav-link">文章</a></div><div class="nav-item"><a href="/resume/" class="nav-link">个人简历</a></div><div class="nav-item"><a href="https://github.com/Mavericker-1996/Mavericker-1996.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/network/" class="nav-link">网络</a></div><div class="nav-item"><a href="/css/" class="nav-link">CSS</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/basic/" class="nav-link router-link-active">JavaScript基础</a></li><li class="dropdown-item"><!----> <a href="/javascript/pro/" class="nav-link">JavaScript专题</a></li></ul></div></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link">React</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">算法</a></div><div class="nav-item"><a href="/article/" class="nav-link">文章</a></div><div class="nav-item"><a href="/resume/" class="nav-link">个人简历</a></div><div class="nav-item"><a href="https://github.com/Mavericker-1996/Mavericker-1996.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/javascript/basic/" class="sidebar-link">JavaScript基础</a></li><li><a href="/javascript/basic/类型转换.html" class="sidebar-link">类型转换</a></li><li><a href="/javascript/basic/let和const.html" class="sidebar-link">let和const</a></li><li><a href="/javascript/basic/this相关.html" class="active sidebar-link">this相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#一句话总结" class="sidebar-link">一句话总结</a></li><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#默认绑定" class="sidebar-link">默认绑定</a></li><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#隐式绑定" class="sidebar-link">隐式绑定</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#隐式丢失" class="sidebar-link">隐式丢失</a></li></ul></li><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#显示绑定" class="sidebar-link">显示绑定</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#模拟实现call" class="sidebar-link">模拟实现call</a></li><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#模拟实现apply" class="sidebar-link">模拟实现apply</a></li><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#模拟实现bind" class="sidebar-link">模拟实现bind</a></li></ul></li><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#new绑定" class="sidebar-link">new绑定</a></li><li class="sidebar-sub-header"><a href="/javascript/basic/this相关.html#箭头函数中的this" class="sidebar-link">箭头函数中的this</a></li></ul></li><li><a href="/javascript/basic/作用域链.html" class="sidebar-link">作用域链</a></li><li><a href="/javascript/basic/原型.html" class="sidebar-link">原型</a></li><li><a href="/javascript/basic/原型与继承.html" class="sidebar-link">继承  </a></li><li><a href="/javascript/basic/垃圾回收和内存泄漏.html" class="sidebar-link">垃圾回收和内存泄漏</a></li><li><a href="/javascript/basic/深拷贝与浅拷贝.html" class="sidebar-link">深拷贝与浅拷贝</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="this相关"><a href="#this相关" aria-hidden="true" class="header-anchor">#</a> this相关</h1> <p>最近在学习react过程中对于this又有了一些新的看法，所以打算将其抽出来单独写一篇来梳理一下。</p> <h2 id="一句话总结"><a href="#一句话总结" aria-hidden="true" class="header-anchor">#</a> 一句话总结</h2> <p><code>this</code>实际上是在普通函数被调用时发生的绑定，它指向什么完全取决于函数在哪里被调用。</p> <p>在 ES5 中，其实 this 的指向，始终坚持一个原理：<strong>this 永远指向最后调用它的那个对象</strong>。其中一共有4种绑定规则：默认绑定，隐式绑定，显示绑定，new绑定。</p> <h2 id="默认绑定"><a href="#默认绑定" aria-hidden="true" class="header-anchor">#</a> 默认绑定</h2> <p>在非严格模式下，默认指向window；在严格模式下，指向到undefined。</p> <h2 id="隐式绑定"><a href="#隐式绑定" aria-hidden="true" class="header-anchor">#</a> 隐式绑定</h2> <p>判断调用位置是否有上下文对象，或者说被某个对象拥有或者包含</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>  
    a <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>  
    foo <span class="token punctuation">:</span> foo  
<span class="token punctuation">}</span>  
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>  
    a <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  
    obj1 <span class="token punctuation">:</span> obj1  
<span class="token punctuation">}</span>  
obj2<span class="token punctuation">.</span>obj1<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//结果：2，绑定到最后一层会影响调用位置</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="隐式丢失"><a href="#隐式丢失" aria-hidden="true" class="header-anchor">#</a> 隐式丢失</h3> <p><strong>隐式丢失</strong>： 常见的this绑定问题就是“隐式绑定”的函数会丢失绑定对象，也就是“默认绑定”，从而把this绑定到全局对象（严格模式下为undefined）。举一个例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">;</span>  
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>  
    a <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>  
    foo <span class="token punctuation">:</span> foo  
<span class="token punctuation">}</span>  
<span class="token keyword">var</span> bar <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>  
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//&quot;foo&quot;  </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>由于函数是<strong>按引用传递</strong>的，即指向同一个地址，所以虽然bar是obj.foo的一个引用，但是实际上，它引用的是foo函数本身，因此此时的bar()其实是不带任何修饰的函数调用，因此应用了默认绑定。</p> <p>改成这样也依然会发生隐式丢失，且与上面等价：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">;</span>  
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>  
    a <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>  
    foo <span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//把函数放里面</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>    
<span class="token punctuation">}</span>  
<span class="token keyword">var</span> bar <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>  
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//&quot;foo&quot; </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>更常见的是发生在<strong>函数作为参数来进行参数传递</strong>时，也就是所谓的在<strong>回调函数</strong>中，因为<strong>参数传递其实就是一种隐式赋值，因此传入函数时会被隐式赋值</strong>。这段话很重要，一定要好好理解！</p> <p>举个例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">;</span>  
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token keyword">function</span> <span class="token function">doFoo</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//发生隐式赋值，相当于var fn = obj.foo，所以指向window</span>
    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>  
    a <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>  
    foo <span class="token punctuation">:</span> foo  
<span class="token punctuation">}</span>  
<span class="token function">doFoo</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;foo&quot;  </span>
  
<span class="token function">setTimeout</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//&quot;foo&quot;，当回调函数名作为参数时，同样发生了隐式赋值，所以指向window</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>所以在react中处理事件时，需要在constructor中使用<code>bind</code>对进行绑定，使函数中的<code>this</code>在回调中（比如onClick）起作用，只有这样你才能访问到<code>state</code>和<code>prop</code>这些属性。如果你忘记绑定 <code>this.handleClick</code> 并将其传递给<code>onClick</code>，那么在直接调用该函数时，<code>this</code> 会是 <code>undefined</code> 。一句话概括原因就是：<strong>函数作为参数传入时会发生隐式绑定丢失</strong> 。</p> <p>当然也可以在jsx中进行绑定：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">Title</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">handleClickOnTitle</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClickOnTitle<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">React 小书</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>具体例子参考这篇<a href="http://huziketang.mangojuice.top/books/react/lesson9" target="_blank" rel="noopener noreferrer">文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>这篇国外<a href="https://www.smashingmagazine.com/2014/01/understanding-javascript-function-prototype-bind/" target="_blank" rel="noopener noreferrer">文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>关于为何要使用<code>bind</code>写的真的很棒，分析的很透彻，可以读一下，在后面关于<code>bind</code>的使用时我会再次提起它。</p> <h2 id="显示绑定"><a href="#显示绑定" aria-hidden="true" class="header-anchor">#</a> 显示绑定</h2> <p>即通过<code>apply</code>，<code>call</code>，<code>bind</code>三个函数进行显示绑定。</p> <p><code>apply</code>和<code>call</code>差不多，只是接受参数上有一点差别，区别是 call 方法接受的是若干个参数列表，而 apply 接收的是一个包含多个参数的数组。</p> <p><code>bind</code>方法创建一个新的函数， 当被调用时，将其this关键字设置为提供的值，在调用新函数时，在任何提供之前提供一个给定的参数序列。</p> <p>下面我们分别来模拟实现这三个函数来加深理解：</p> <h3 id="模拟实现call"><a href="#模拟实现call" aria-hidden="true" class="header-anchor">#</a> 模拟实现call</h3> <p>参考文章：<a href="https://github.com/mqyqingfeng/Blog/issues/11" target="_blank" rel="noopener noreferrer">JavaScript深入之call和apply的模拟实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>一句话介绍 call：</p> <blockquote><p>call() 方法在使用一个指定的 this 值和若干个指定的参数值的前提下调用某个函数或方法。</p></blockquote> <p>举个例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

bar<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>注意两点：</p> <ol><li>call 改变了 this 的指向，指向到 foo</li> <li>bar 函数执行了</li></ol> <p>那么我们该怎么模拟实现这两个效果呢？</p> <p>试想当调用 call 的时候，把 foo 对象改造成如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    bar<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>这个时候 this 就指向了 foo，是不是很简单呢？</p> <p>但是这样却给 foo 对象本身添加了一个属性，这可不行呐！</p> <p>不过也不用担心，我们用 delete 再删除它不就好了~</p> <p>所以我们模拟的步骤可以分为：</p> <ol><li>将函数设为对象的属性</li> <li>执行该函数</li> <li>删除该函数</li></ol> <p>以上个例子为例，就是：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 第一步</span>
foo<span class="token punctuation">.</span>fn <span class="token operator">=</span> bar
<span class="token comment">// 第二步</span>
foo<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 第三步</span>
<span class="token keyword">delete</span> foo<span class="token punctuation">.</span>fn
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>fn 是对象的属性名，反正最后也要删除它，所以起成什么都无所谓。</p> <p>然后我们还需要注意不定参数的问题，this参数传递null问题，函数返回值问题。</p> <p>综上，我们可以写出如下代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Function<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">call2</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> context <span class="token operator">=</span> context <span class="token operator">||</span> window<span class="token punctuation">;</span>
	context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> res <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
	<span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 测试一下</span>
<span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        value<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> name<span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> age
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

bar<span class="token punctuation">.</span><span class="token function">call2</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bar<span class="token punctuation">.</span><span class="token function">call2</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'kevin'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1</span>
<span class="token comment">// Object {</span>
<span class="token comment">//    value: 1,</span>
<span class="token comment">//    name: 'kevin',</span>
<span class="token comment">//    age: 18</span>
<span class="token comment">// }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="模拟实现apply"><a href="#模拟实现apply" aria-hidden="true" class="header-anchor">#</a> 模拟实现apply</h3> <p>思路类似，只不过apply可以接受一个数组或者类数组对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Function<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">apply2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> context <span class="token operator">=</span> context <span class="token operator">||</span> window
  context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>

  <span class="token keyword">var</span> result
  <span class="token comment">// 需要判断是否存储第二个参数</span>
  <span class="token comment">// 如果存在，就将第二个参数展开</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="模拟实现bind"><a href="#模拟实现bind" aria-hidden="true" class="header-anchor">#</a> 模拟实现bind</h3> <p>由于内容较多，请看我的另一篇文章<a href="/article/bind.html">模拟实现bind</a>。</p> <h2 id="new绑定"><a href="#new绑定" aria-hidden="true" class="header-anchor">#</a> new绑定</h2> <p>参考文章：<a href="https://github.com/mqyqingfeng/Blog/issues/13" target="_blank" rel="noopener noreferrer">JavaScript深入之new的模拟实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>new过程如下：</p> <ol><li>创建一个空对象 obj</li> <li>将新创建的空对象执行原型链接</li> <li>将this绑定到这个新对象</li> <li>如果无返回值或者返回一个非对象值，则将 obj 返回作为新对象；如果返回值是一个新对象的话那么直接直接返回该对象。</li></ol> <p>举个例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Otaku 御宅族，简称宅</span>
<span class="token keyword">function</span> <span class="token function">Otaku</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>habit <span class="token operator">=</span> <span class="token string">'Games'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 因为缺乏锻炼的缘故，身体强度让人担忧</span>
Otaku<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>strength <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>

Otaku<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayYourName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I am '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Otaku</span><span class="token punctuation">(</span><span class="token string">'Kevin'</span><span class="token punctuation">,</span> <span class="token string">'18'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// Kevin</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>habit<span class="token punctuation">)</span> <span class="token comment">// Games</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>strength<span class="token punctuation">)</span> <span class="token comment">// 60</span>

person<span class="token punctuation">.</span><span class="token function">sayYourName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// I am Kevin</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>从这个例子中，我们可以看到，实例 person 可以：</p> <ol><li>访问到 Otaku 构造函数里的属性</li> <li>访问到 Otaku.prototype 中的属性和方法</li></ol> <p>所以我们可以看到，在 new 的过程中，我们改变了 this 的指向。下面我们来模拟实现一下new：</p> <p>因为 new 是关键字，所以无法像 bind 函数一样直接覆盖，所以我们写一个函数，命名为 create，来模拟 new 的效果。用的时候是这样的：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Otaku</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ……
<span class="token punctuation">}</span>

<span class="token comment">// 使用 new</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Otaku</span><span class="token punctuation">(</span>……<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 使用 objectFactory</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span>Otaku<span class="token punctuation">,</span> ……<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>首先说一下<code>Array.prototype</code>中的<code>shift</code>方法：</p> <p><code>shift()</code> 方法从数组中<strong>删除</strong>第一个元素，并返回该元素的值。此方法更改数组的长度。 <code>shift</code> 方法并不局限于数组：这个方法能够通过call或 apply方法作用于类似数组的对象上。但是对于没有 length 属性（从0开始的一系列连续的数字属性的最后一个）的对象，调用该方法可能没有任何意义。</p> <p>所以我们可以写出如下函数：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建一个空的对象</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 获得构造函数,取得该方法的第一个参数(并删除第一个参数)，该参数是构造函数</span>
    <span class="token keyword">let</span> Con <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 链接到原型</span>
    obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> Con<span class="token punctuation">.</span>prototype
    <span class="token comment">// 绑定 this，执行构造函数</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> Con<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
    <span class="token comment">// 确保 new 出来的是个对象，如果return null的话也得返回obj</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> result <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">?</span> result <span class="token operator">||</span> obj <span class="token punctuation">:</span> obj   
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="箭头函数中的this"><a href="#箭头函数中的this" aria-hidden="true" class="header-anchor">#</a> 箭头函数中的this</h2> <p>箭头函数因为本身没有this，它会直接绑定到定义它时的作用域内的this值。引用一篇博客里面的一句话：</p> <blockquote><ol><li>如果箭头函数被非箭头函数包含，则 this 绑定的是最近一层非箭头函数的 this，否则，this 为 window或者undefined。</li> <li>箭头函数的 this 一旦绑定了上下文，就不会被任何代码改变。</li></ol></blockquote> <p>举个例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;windowsName&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
        name <span class="token punctuation">:</span> <span class="token string">&quot;Cherry&quot;</span><span class="token punctuation">,</span>

        func1<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>     
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        func2<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//这里的this指向a</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    a<span class="token punctuation">.</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment">// Cherry</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>它也相当于：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>        func2<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _this<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>再来一个面试题体验一下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    b<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

obj<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj</span>
obj<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>更多例子详见《你不知道的JavaScript》上册，或者这篇<a href="https://www.cnblogs.com/wyaocn/p/5774429.html" target="_blank" rel="noopener noreferrer">文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/23.a1aadb14.js" defer></script><script src="/assets/js/app.813c17b6.js" defer></script>
  </body>
</html>
